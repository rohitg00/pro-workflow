{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "tool == \"Edit\" || tool == \"Write\"",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/quality-gate.js\""
          }
        ],
        "description": "Track edits for quality gate checks"
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git commit\"",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"console.error('[ProWorkflow] Before commit: lint, typecheck, test?');console.error('[ProWorkflow] Run quality gates first: npm run lint && npm run typecheck')\""
          }
        ],
        "description": "Remind to run quality gates before commit"
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git push\"",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"console.error('[ProWorkflow] Pushing to remote...');console.error('[ProWorkflow] Consider /wrap-up to capture learnings from this session')\""
          }
        ],
        "description": "Remind about wrap-up before push"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.(ts|tsx|js|jsx|py|go|rs)$\"",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/post-edit-check.js\""
          }
        ],
        "description": "Check for common issues after code edits"
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"(npm test|pnpm test|yarn test|pytest|go test)\"",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{const i=JSON.parse(d);const out=i.tool_output?.output||'';if(/fail|error|FAIL/i.test(out)){console.error('[ProWorkflow] Tests failed - fix before proceeding');console.error('[ProWorkflow] Consider: [LEARN] Testing: '+out.split('\\n').find(l=>/fail|error/i.test(l))?.slice(0,80))}console.log(d)})\""
          }
        ],
        "description": "Suggest learning from test failures"
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/session-check.js\""
          }
        ],
        "description": "Periodic wrap-up reminder and learning prompt"
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/learn-capture.js\""
          }
        ],
        "description": "Auto-capture [LEARN] blocks from responses into database"
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/session-start.js\""
          }
        ],
        "description": "Load LEARNED patterns and previous session context"
      }
    ],
    "SessionEnd": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/session-end.js\""
          }
        ],
        "description": "Prompt for learnings and update LEARNED.md"
      }
    ],
    "UserPromptSubmit": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/prompt-submit.js\""
          }
        ],
        "description": "Track prompts and detect correction patterns"
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/drift-detector.js\""
          }
        ],
        "description": "Detect task drift and remind about original intent"
      }
    ],
    "PreCompact": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/pre-compact.js\""
          }
        ],
        "description": "Save context state before compaction"
      }
    ],
    "Notification": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"let d='';process.stdin.on('data',c=>d+=c);process.stdin.on('end',()=>{const i=JSON.parse(d);if(i.type==='PermissionRequest'){console.error('[ProWorkflow] Permission requested: '+i.tool)}console.log(d)})\""
          }
        ],
        "description": "Log permission requests"
      }
    ]
  }
}
